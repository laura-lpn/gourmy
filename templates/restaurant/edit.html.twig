{% extends 'base.html.twig' %}

{% block title %}Éditer mon restaurant
{% endblock %}

{% block body %}
	<div class="w-2/5 mx-auto px-6 py-8 mt-28">

		<h1 class="text-3xl font-second font-medium text-orange text-center mb-8">Éditer mon restaurant</h1>

		{% for label, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ label }} mb-4">
					{% autoescape false %}
						{{ message }}
					{% endautoescape %}
				</div>
			{% endfor %}
		{% endfor %}

		{{ form_start(restaurantForm, {'attr': {'class': 'space-y-8'}}) }}

		{# Infos générales #}
		<section class="bg-blue/5 rounded-xl p-6">
			<h2 class="text-xl font-medium flex gap-6 items-center font-second text-blue mb-4">
				<span class="h-0.5 rounded-md bg-blue w-8 block"></span>
				Informations générales
			</h2>
			<div class="space-y-4">
				{{ form_row(restaurantForm.name) }}
				{{ form_row(restaurantForm.siret) }}
				{{ form_row(restaurantForm.bannerFile) }}
				{{ form_row(restaurantForm.description) }}
			</div>
		</section>

		{# Images du restaurant #}
		<section class="bg-orange/5 rounded-xl p-6">
			<h2 class="text-xl font-medium flex gap-6 items-center font-second text-orange mb-4">
				<span class="h-0.5 rounded-md bg-orange w-8 block"></span>
				Images du restaurant
			</h2>
			<image-uploader data-prototype="{{ form_widget(restaurantForm.images.vars.prototype) | e('html_attr') }}">
				<div class="existing-images grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
					{% for imageField in restaurantForm.images %}
						<div class="relative image-item w-40 h-40 bg-gray-100 rounded-lg overflow-hidden cursor-pointer" style="background-image: url('{{ vich_uploader_asset(imageField.vars.value, 'imageFile') }}');
								background-size: cover;
								background-position: center;">
							{{ form_widget(imageField.imageFile, {'attr': {'class': 'hidden image-input'}}) }}
							{{ form_widget(imageField._delete, {'attr': {'class': 'delete-flag hidden'}}) }}
							<button type="button" class="absolute top-1 right-1 bg-blue text-white text-xs rounded-full px-2 py-1 remove-image-btn">
								<i class="fa-solid fa-xmark"></i>
							</button>
						</div>
					{% endfor %}
				</div>
			</image-uploader>
			<script type="module" src="{{ asset('webcomponents/ImageUploader.js') }}"></script>
		</section>

		{# Coordonnées #}
		<section class="bg-blue/5 rounded-xl p-6">
			<h2 class="text-xl font-medium flex gap-6 items-center font-second text-blue mb-4">
				<span class="h-0.5 rounded-md bg-blue w-8 block"></span>
				Coordonnées
			</h2>
			<div class="space-y-4">
				{{ form_row(restaurantForm.address) }}
				{{ form_row(restaurantForm.postalCode) }}
				{{ form_row(restaurantForm.city) }}
				{{ form_row(restaurantForm.country) }}
				{{ form_row(restaurantForm.phoneNumber) }}
			</div>
		</section>

		{# Infos pratiques #}
		<section class="bg-orange/5 rounded-xl p-6">
			<h2 class="text-xl font-medium flex gap-6 items-center font-second text-orange mb-4">
				<span class="h-0.5 rounded-md bg-orange w-8 block"></span>
				Infos pratiques
			</h2>
			<div class="space-y-4">
				{{ form_row(restaurantForm.openingHours) }}
				{{ form_row(restaurantForm.types) }}
				{{ form_row(restaurantForm.priceRange) }}
				{{ form_row(restaurantForm.website) }}
			</div>
		</section>

		<div class="flex justify-center gap-4 mt-6">
			<a href="{{ path('app_restaurateur') }}" class="btn-secondary">Annuler</a>
			<button type="submit" class="btn">Modifier</button>
		</div>

		{{ form_end(restaurantForm) }}
	</div>
{% endblock %}
