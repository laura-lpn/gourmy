{% extends 'base.html.twig' %}

{% block title %}
	{{ restaurant.name }}
{% endblock %}

{% block body %}
	<section class="w-3/4 mx-auto px-6 py-8 mt-28">
		<div class="flex flex-col md:flex-row gap-12 items-start relative">
			<div class="relative md:w-1/2 w-full">
				{% if restaurant.bannerName %}
					<img src="{{ vich_uploader_asset(restaurant, 'bannerFile') }}" alt="Image de {{ restaurant.name }}" class="rounded-xl w-full h-80 object-cover">
				{% endif %}
				<div class="absolute -bottom-5 -right-5 w-20 h-20 bg-white rounded-full shadow-lg flex items-center justify-center">
					<img src="{{ asset('images/chef-hat-blue.svg') }}" alt="Badge" class="w-16 h-16">
				</div>
			</div>

			<div class="flex-1">
				<h1 class="text-3xl font-second font-medium text-blue mb-2">{{ restaurant.name }}</h1>
				<p class="text-sm font-medium mb-3">
					{{ restaurant.types|map(t => t.name)|join(', ') }}
				</p>
				<p class="mb-4">{{ restaurant.description }}</p>

				<div class="flex items-center gap-1 text-blue mb-2">
					{% set avg = restaurant.averageRating %}
					{% for i in 1..5 %}
						<i class="fa{{ avg >= i ? 's' : (avg >= i - 0.5 ? 's' : 'r') }} fa-star text-sm"></i>
					{% endfor %}
					<span class="text-sm text-black ml-2">
						{{ restaurant.reviews|filter(r => not r.response)|length }}
						avis
					</span>
				</div>
			</div>
		</div>

		<div class="mt-12 bg-orange/5 rounded-xl p-6">
			<h2 class="text-xl font-medium flex gap-6 items-center font-second text-orange mb-4">
				<span class="h-0.5 rounded-md bg-orange w-8 block"></span>Images du restaurant</h2>
			<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
				{% for review in images %}
					<img src="{{ vich_uploader_asset(review, 'imageFile') }}" alt="..." class="rounded-lg object-cover w-48 h-48"/>
				{% endfor %}
				{% if images|length == 0 %}
					<p class="text-center col-span-full text-sm">Aucune image pour ce restaurant.</p>
				{% endif %}
			</div>
		</div>

		<div class="mt-12">
			<review-list restaurant-id="{{ restaurant.id }}" user-id="{{ app.user ? app.user.id : '' }}" user-username="{{ app.user ? app.user.username : '' }}" is-owner="{{ isOwner ? '1' : '0' }}" editable="true" added="true"></review-list>
		</div>
	</section>

	<script type="module" src="{{ asset('webcomponents/reviews/ReviewList.js') }}"></script>
	<script type="module" src="{{ asset('webcomponents/ModalConfirm.js') }}"></script>
{% endblock %}
