{% extends 'base.html.twig' %}

{% block title %}Admin - Tableau de bord
{% endblock %}

{% block body %}
	<div
		class="mt-28 max-w-6xl mx-auto px-6">

		<!-- Titre principal -->
		<h1 class="my-h1 text-center mb-10">
			Tableau de bord
		</h1>

		<!-- Statistiques principales -->
		<div class="grid md:grid-cols-3 gap-6 mb-10">
			<div class="bg-blue/5 rounded-xl p-6 text-center border border-blue/10">
				<h2 class="text-blue text-3xl font-second font-medium">{{ restaurantsValidated }}</h2>
				<p class="text-sm">Restaurants validés</p>
			</div>
			<div class="bg-orange/5 rounded-xl p-6 text-center border border-orange/10">
				<h2 class="text-orange text-3xl font-second font-medium">{{ restaurantsPending }}</h2>
				<p class="text-sm">Restaurants en attente</p>
				<a href="{{ path('app_admin_restaurants') }}" class="mt-3 inline-flex items-center text-orange text-sm font-medium hover:text-orange/80">
					<i class="fa-solid fa-arrow-right mr-1"></i>
					Gérer
				</a>
			</div>
			<div class="bg-lime-50 rounded-xl p-6 text-center border border-lime-100">
				<h2 class="text-lime-600 text-3xl font-second font-medium">{{ roadtripsPublic }}</h2>
				<p class="text-sm">Roadtrips publics</p>
			</div>
			<div class="bg-violet-50 rounded-xl p-6 text-center border border-violet-100">
				<h2 class="text-violet-600 text-3xl font-second font-medium">{{ users }}</h2>
				<p class="text-sm">Utilisateurs</p>
			</div>
			<div class="bg-amber-50 rounded-xl p-6 text-center border border-amber-100">
				<h2 class="text-amber-600 text-3xl font-second font-medium">{{ reviews }}</h2>
				<p class="text-sm">Avis</p>
			</div>
			<div class="bg-rose-50 rounded-xl p-6 text-center border border-rose-100">
				<h2 class="text-3xl font-second text-rose-600 font-medium">{{ badgesCount }}</h2>
				<p class="text-sm">Badges</p>
				<a href="{{ path('app_admin_badges') }}" class="mt-3 inline-flex items-center text-rose-600 text-sm font-medium hover:text-rose-600/80">
					<i class="fa-solid fa-arrow-right mr-1"></i>
					Gérer
				</a>
			</div>
		</div>

		<!-- Top 5 utilisateurs -->
		<section class="rounded-xl bg-blue/5 p-6">
			<h2 class="text-2xl font-second text-blue flex items-center gap-3 mb-8">
				<span class="h-1 w-8 bg-blue inline-block rounded"></span>
				Top 5 des utilisateurs les plus actifs
			</h2>
			<table class="w-full border-collapse rounded-xl border border-blue/10 overflow-hidden bg-blue/5">
				<thead>
					<tr class="bg-blue/5 text-blue text-sm uppercase font-second">
						<th class="p-2 text-left">Utilisateur</th>
						<th class="p-2 text-center">Points</th>
						<th class="p-2 text-center">Badges</th>
					</tr>
				</thead>
				<tbody>
					{% for user in topUsers %}
						<tr class="border-b">
							<td class="p-2 flex items-center gap-2">
								{% if user.avatarName %}
									<img src="{{ vich_uploader_asset(user, 'avatarFile') }}" alt="Avatar" class="w-6 rounded-full">
								{% else %}
									<img src="{{ asset('images/avatar-placeholder.png') }}" alt="Avatar par défaut" class="w-6 rounded-full">
								{% endif %}
								<span>{{ user.username }}</span>
							</td>
							<td class="p-2 text-center">{{ user.points }}</td>
							<td class="p-2 text-center">
								<span class="text-sm">{{ user.badges|length }}</span>
							</td>
						</tr>
					{% else %}
						<tr>
							<td colspan="3" class="text-center p-4 text-gray-500">Aucun utilisateur actif trouvé.</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</section>

	</div>
{% endblock %}
